{"version":3,"file":"simple-vue.cjs.js","sources":["../src/shared/index.ts","../src/runtime-core/component.ts","../src/runtime-core/runderer.ts","../src/runtime-core/vnode.ts","../src/runtime-core/createApp.ts","../src/runtime-core/h.ts"],"sourcesContent":["export const extend = Object.assign;\n\nexport function isObject(obj: unknown){\n  return obj instanceof Object && obj !== null\n}\n\nexport function hasChanged(value, oldValue) {\n  return !Object.is(value, oldValue);\n}","\nexport function createComponentInstance(vnode: any) {\n  const component = {\n    vnode,\n    type: vnode.type\n  }\n\n  return component\n}\n\nexport function setupComponent(instance: any) {\n  // TODO\n  // 初始化props\n  // 初始化slots\n\n  //\n  setupStatefulComponent(instance)\n}\n\nfunction setupStatefulComponent(instance: any) {\n\n  const { setup } = instance.vnode.type\n  if(setup) {\n    const setupResult = setup()\n    handlerSetupResult(instance, setupResult)\n  }\n}\n\nfunction handlerSetupResult(instance: any, setupResult: any) {\n  // 这里传过来的setupResult可能是个函数或对象\n\n  if(typeof setupResult === 'object') {\n    instance.setupState = setupResult\n  }\n\n  // TODO\n  // 如果是函数，则当成render函数渲染\n\n  finishComponentSetup(instance)\n}\n\nfunction finishComponentSetup(instance: any) {\n  const Component = instance.type\n\n  // if(Component.render) {\n    instance.render = Component.render\n  // }\n}\n\n","import { isObject } from \"../shared/index\"\nimport { createComponentInstance, setupComponent } from \"./component\"\n\n// 将虚拟节点渲染到真实dom\nexport function render(vnode, container) {\n  // patch\n\n  path(vnode, container)\n}\n\nfunction path(vnode, container) {\n  // 处理组件\n  /**\n   * 通过vnode.type判断是否是组件\n   */\n    if(typeof vnode.type === \"string\") {\n      processElement(vnode, container)\n    }\n    else if(isObject(vnode.type)) {\n      processComponent(vnode, container)\n    }\n}\n\nfunction processElement(vnode: any, container: any) {\n  mountElement(vnode, container)\n}\n\nfunction mountElement(vnode: any, container: any) {\n  const { type, props, children } = vnode\n\n  const el = document.createElement(type);\n\n  if(typeof children === \"string\") {\n    el.textContent = children\n  }else if(Array.isArray(children)) {\n    mountChildren(vnode, el)\n  }\n\n  for (const key in props) {\n    el.setAttribute(key, props[key])\n  }\n\n  container.appendChild(el)\n\n}\n\nfunction mountChildren(vnode, container) {\n  vnode.children.map(v => path(v, container))\n}\n\nfunction processComponent(vnode: any, container: any) {\n  // 挂载组件\n  mountComponent(vnode, container)\n}\n\nfunction mountComponent(vnode: any, container: any) {\n  const instance = createComponentInstance(vnode)\n\n  setupComponent(instance)\n\n  setupRenderEffect(instance, container)\n}\n\nfunction setupRenderEffect(instance: any, container: any) {\n  const subTree = instance.render()\n\n  // vnode -> path\n  // vnode -> element -> mountElement\n  path(subTree, container)\n}\n","\n\nexport function createVNode(type, props?, children?) {\n  const vnode = {\n    type,\n    props,\n    children,\n  }\n\n  return vnode\n}","import { render } from \"./runderer\"\nimport { createVNode } from \"./vnode\"\n\n\nexport function createApp(rootComponent) {\n  return {\n    mount(domId: string) {\n      const rootContainer = document.querySelector(domId)\n      if (!rootContainer) {\n        throw new Error(`找不到指定的dom元素: ${domId}`)\n      }\n      // 先将根组件转化成虚拟节点\n      const vnode = createVNode(rootComponent)\n      // 渲染节点\n      render(vnode, rootContainer)\n    }\n  }\n}\n\n\n\n","\nimport { createVNode } from \"./vnode\";\n\nexport function h (type: any, props?: any, children?: any) {\n\n  // 创建虚拟节点\n  const vnode = createVNode(type, props, children)\n\n  return vnode\n}"],"names":[],"mappings":"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"}